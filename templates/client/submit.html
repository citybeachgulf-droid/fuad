{% extends 'layout.html' %}
{% block content %}
<h2 class="mb-3">طلب تثمين جديد</h2>

<div class="mb-4">
  <div class="progress" style="height: 8px;">
    <div class="progress-bar" role="progressbar" style="width: 50%"></div>
  </div>
  <small class="text-muted">الخطوة 1/2: نوع التثمين</small>
  <div class="text-muted">اختر النوع للمتابعة تلقائيًا</div>
  <hr>
</div>

<form method="POST" id="typeForm">
  <div class="mb-3">
    <label class="form-label d-block">نوع التثمين</label>
    <div class="tile-grid">
      <label class="tile-select tile-success">
        <input type="radio" name="valuation_type" value="property" required>
        <span class="tile-icon bg-white text-success"><i class="bi bi-house"></i></span>
        <div>
          <p class="tile-label m-0">شراء منزل</p>
          <p class="tile-desc m-0">تقييم لغرض الشراء</p>
        </div>
      </label>
      <label class="tile-select tile-primary">
        <input type="radio" name="valuation_type" value="land" required>
        <span class="tile-icon bg-white text-primary"><i class="bi bi-geo"></i></span>
        <div>
          <p class="tile-label m-0">شراء أرض</p>
          <p class="tile-desc m-0">قطعة أرض بدون بناء</p>
        </div>
      </label>
      <label class="tile-select tile-warning">
        <input type="radio" name="valuation_type" value="house" required>
        <span class="tile-icon bg-white text-warning"><i class="bi bi-tools"></i></span>
        <div>
          <p class="tile-label m-0">بناء منزل</p>
          <p class="tile-desc m-0">تقييم لغرض البناء</p>
        </div>
      </label>
    </div>
  </div>
  <input type="hidden" name="company_id" value="{{ preselected_company_id or '' }}">
  <div class="d-flex gap-2">
    <button class="btn btn-primary" type="submit">متابعة</button>
    <a href="{{ url_for('client.dashboard') }}" class="btn btn-secondary">إلغاء</a>
  </div>
  
</form>
{% endblock %}

{% block scripts %}
{{ super() }}
<script>
(function(){
  const form = document.getElementById('typeForm');
  document.querySelectorAll('input[name="valuation_type"]').forEach(function(r){
    r.addEventListener('change', function(){
      form.requestSubmit();
    });
  });
})();
</script>
{% endblock %}

